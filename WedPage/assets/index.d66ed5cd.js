import { d as E, r as b, w as I, c as J, F as K, a as R, o as y, b as $, e as i, f as O, t as N, C as P, g as v, _ as q, U as F, h as c, u as f, i as G, j as H, k as z, l as D, m as V, n as X, p as g, B as L, S as M, q as C, T as Q, s as W, v as Y, x as Z, y as ee, z as te, A, D as oe, I as ne, E as se, G as ae } from "./vendor.84ad9896.js"; const re = function () { const e = document.createElement("link").relList; if (e && e.supports && e.supports("modulepreload")) return; for (const n of document.querySelectorAll('link[rel="modulepreload"]')) o(n); new MutationObserver(n => { for (const l of n) if (l.type === "childList") for (const s of l.addedNodes) s.tagName === "LINK" && s.rel === "modulepreload" && o(s) }).observe(document, { childList: !0, subtree: !0 }); function a(n) { const l = {}; return n.integrity && (l.integrity = n.integrity), n.referrerpolicy && (l.referrerPolicy = n.referrerpolicy), n.crossorigin === "use-credentials" ? l.credentials = "include" : n.crossorigin === "anonymous" ? l.credentials = "omit" : l.credentials = "same-origin", l } function o(n) { if (n.ep) return; n.ep = !0; const l = a(n); fetch(n.href, l) } }; re(); var w = (t, e) => { const a = t.__vccOpts || t; for (const [o, n] of e) a[o] = n; return a }; const le = E({ name: "GetJsonParase", props: { records: { type: Array, default: () => [] } }, setup(t) { let e = b(); return I(() => t.records, a => { e.value = a }, { immediate: !0 }), { msg: b("\u6D4B\u8BD5"), recordsHis: e } } }), ce = { class: "row-box center scroll-box" }; function ie(t, e, a, o, n, l) { const s = P; return y(), J("div", ce, [(y(!0), J(K, null, R(t.recordsHis, (r, u) => (y(), $(s, { key: r, hoverable: "", title: `\u8BB0\u5F55${u + 1}`, style: { width: "300px", height: "200px", margin: "6px" } }, { default: i(() => [O("p", null, N(r.file), 1)]), _: 2 }, 1032, ["title"]))), 128))]) } var U = w(le, [["render", ie]]); const ue = { name: "TableSource", props: { tableOptions: { type: Object, default: () => ({ columns: [], dataSource: [] }) } }, setup(t) { let e = v({ columns: [], dataSource: [] }); return I(() => t.tableOptions, a => { e.columns = a.columns, e.dataSource = a.dataSource }, { immediate: !1, deep: !0 }), { tableReciver: e } } }; function pe(t, e, a, o, n, l) { const s = q; return y(), $(s, { class: "table-box open-select", bordered: "", dataSource: o.tableReciver.dataSource, columns: o.tableReciver.columns, pagination: !1 }, null, 8, ["dataSource", "columns"]) } var T = w(ue, [["render", pe]]); const de = t => { let e = JSON.parse(sessionStorage.getItem("importhistory")); Array.isArray(e) ? e.length && (e.push(t), sessionStorage.setItem("importhistory", JSON.stringify(e))) : sessionStorage.setItem("importhistory", JSON.stringify(new Array(t))) }, _e = t => JSON.parse(sessionStorage.getItem("importhistory")), me = { class: "row-box" }, B = { emits: ["SendJsonExcel"], setup(t, { emit: e }) { let a = v([]); const o = v({ headers: { authorization: "authorization-user-token" }, action: "/", multiple: !1, label: "\u4E0A\u4F20Excel\u6587\u4EF6", icon: F, accept: ".xlsx", showUploadList: !1 }), n = s => { console.log("f", s), de({ file: s.file.name }), l(s.file).then(r => { e("SendJsonExcel", { isOk: !0, jsonExcel: r }) }).catch(r => { e("SendJsonExcel", { isOk: !1 }) }) }, l = s => { let r = s.name.split("."), u = r[r.length - 1]; return ["xlsx", "csv"].includes(u) ? new Promise((d, p) => { let m = new FileReader; m.readAsBinaryString(s), m.onload = function (_) { let S = _.target.result; try { var k = z(S, { type: "binary" }); const x = k.SheetNames[0], h = D.sheet_to_json(k.Sheets[x]); d(h) } catch { p("some wrong with import") } } }) : !1 }; return (s, r) => { const u = L, d = V; return y(), J("div", me, [c(d, { "file-list": f(a), "onUpdate:file-list": r[0] || (r[0] = p => G(a) ? a.value = p : a = p), multiple: f(o).multiple, action: f(o).action, headers: f(o).headers, showUploadList: f(o).showUploadList, accept: f(o).accept, customRequest: n }, { default: i(() => [c(u, null, { default: i(() => [(y(), $(X(f(o).icon))), g(" " + N(f(o).label), 1)]), _: 1 })]), _: 1 }, 8, ["file-list", "multiple", "action", "headers", "showUploadList", "accept"]), H(s.$slots, "anyCom")]) } } }, fe = E({ components: { SnippetsOutlined: M }, setup() { return { infos: b("\u4E0A\u4F20Excel\u6587\u4EF6,\u652F\u6301\u8F93\u5165\u8981\u8BFB\u53D6\u7684key,\u70B9\u51FB\u4E00\u952E\u751F\u6210,\u53EF\u751F\u6210\u8868\u683C\u67E5\u770B\u8FDB\u884C\u67E5\u770B") } } }), ye = g("\u4F7F\u7528\u8BF4\u660E"); function he(t, e, a, o, n, l) { const s = C("snippets-outlined"), r = W, u = Y, d = Z, p = Q; return y(), $(p, { class: "col-box" }, { default: i(() => [c(r, { class: "row-box", level: 3 }, { default: i(() => [c(s), ye]), _: 1 }), c(d, null, { default: i(() => [c(u, { strong: "" }, { default: i(() => [g(N(t.infos), 1)]), _: 1 })]), _: 1 })]), _: 1 }) } var j = w(fe, [["render", he]]); const ge = E({ components: { CodepenOutlined: ee, BarsOutlined: te, UploadExcel: B, TableSource: T, GetJsonParase: U, AboutInfo: j }, setup() { const t = v({ columns: [1, 2], dataSource: [6, 6, 6] }), e = b(), a = b(); let o = v({ key: "" }); const n = r => { const { isOk: u, jsonExcel: d } = r; if (u) { let p = Object.keys(d[0]).map(_ => ({ title: _, dataIndex: _, key: _ })), m = d.map((_, S) => Object.assign(_, { key: S + "" })); t.dataSource = m, t.columns = p, e.value = JSON.parse(JSON.stringify(t)) } else A.error("This is an error message") }, l = r => { try { if (r === 1 && o.key.length) { let u = e.value.columns.filter(p => p.key === o.key), d = e.value.dataSource.map((p, m) => ({ key: m + "", [o.key]: p[o.key] })); t.dataSource = d, t.columns = u } else t.dataSource = e.value.dataSource, t.columns = e.value.columns, o.key = "" } catch { A.error("\u8BF7\u5148\u6309\u7167\u6A21\u677F\u63D0\u4F9B\u7684excel,\u586B\u5B8C\u5BFC\u5165\u540E\u518D\u8FDB\u884C\u4E8B\u4EF6\u64CD\u4F5C") } }, s = r => { Number(r) === 2 && (a.value = _e()) }; return { activeKey: b("1"), handleJson: n, records: a, test: t, config: o, handleSearch: l, handleTab: s } } }), be = g(" \u5DE5\u5177 "), Se = { class: "scroll-box" }, ve = g("\u70B9\u51FB\u751F\u6210"), $e = g("\u91CD\u7F6E"), ke = g(" \u8BB0\u5F55 "); function xe(t, e, a, o, n, l) { const s = C("codepen-outlined"), r = j, u = ne, d = L, p = B, m = T, _ = se, S = C("bars-outlined"), k = U, x = oe; return y(), $(x, { activeKey: t.activeKey, "onUpdate:activeKey": e[3] || (e[3] = h => t.activeKey = h), onChange: t.handleTab, centered: "" }, { default: i(() => [c(_, { key: "1" }, { tab: i(() => [O("span", null, [c(s), be])]), default: i(() => [O("div", Se, [c(r), c(p, { onSendJsonExcel: t.handleJson }, { anyCom: i(() => [c(u, { value: t.config.key, "onUpdate:value": e[0] || (e[0] = h => t.config.key = h), style: { width: "200px" }, placeholder: "\u586B\u5199key" }, null, 8, ["value"]), c(d, { onClick: e[1] || (e[1] = h => t.handleSearch(1)) }, { default: i(() => [ve]), _: 1 }), c(d, { onClick: e[2] || (e[2] = h => t.handleSearch(2)) }, { default: i(() => [$e]), _: 1 })]), _: 1 }, 8, ["onSendJsonExcel"]), c(m, { tableOptions: t.test }, null, 8, ["tableOptions"])])]), _: 1 }), c(_, { key: "2" }, { tab: i(() => [O("span", null, [c(S), ke])]), default: i(() => [c(k, { records: t.records }, null, 8, ["records"])]), _: 1 })]), _: 1 }, 8, ["activeKey", "onChange"]) } var Oe = w(ge, [["render", xe]]); ae(Oe).mount("#app");
